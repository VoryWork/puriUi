{"version":3,"file":"collapse.vue2.js","sources":["../../../components/Collapse/collapse.vue"],"sourcesContent":["<template>\r\n  <Transition\r\n    @before-enter=\"collapseBeforeEnter\"\r\n    @enter=\"collapseEnter\"\r\n    @after-enter=\"collapseAfterEnter\"\r\n    @before-leave=\"collapseBeforeLeave\"\r\n    @leave=\"collapseLeave\"\r\n    @after-leave=\"collapseAfterLeave\"\r\n    name=\"puri-collapse-transition\">\r\n    <slot v-if=\"model\"></slot>\r\n  </Transition>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, type RendererElement } from \"vue\";\r\n\r\nconst model = defineModel<boolean>();\r\nconst oldPaddingTop = ref(\"\"),\r\n  oldPaddingBottom = ref(\"\"),\r\n  oldOverflow = ref(\"\");\r\nfunction collapseBeforeEnter(el: RendererElement) {\r\n  // console.log('11, collapseBeforeEnter');\r\n  oldPaddingBottom.value = el.style.paddingBottom;\r\n  oldPaddingTop.value = el.style.paddingTop;\r\n  // 过渡效果开始前设置元素的maxHeight为0，让元素maxHeight有一个初始值\r\n  el.style.paddingTop = \"0\";\r\n  el.style.paddingBottom = \"0\";\r\n  el.style.maxHeight = \"0\";\r\n}\r\nfunction collapseEnter(el: RendererElement, done: () => void) {\r\n  // console.log('22, collapseEnter');\r\n  //\r\n  oldOverflow.value = el.style.overflow;\r\n  let elHeight = el.scrollHeight;\r\n  // 过渡效果进入后将元素的maxHeight设置为元素本身的高度，将元素maxHeight设置为auto不会有过渡效果\r\n  if (elHeight > 0) {\r\n    el.style.maxHeight = elHeight + \"px\";\r\n  } else {\r\n    el.style.maxHeight = \"0\";\r\n  }\r\n  el.style.paddingTop = oldPaddingTop.value;\r\n  el.style.paddingBottom = oldPaddingBottom.value;\r\n\r\n  el.style.overflow = \"hidden\";\r\n  // done();\r\n  let onTransitionDone = function () {\r\n    done();\r\n    // console.log('enter onTransitionDone');\r\n    el.removeEventListener(\"transitionend\", onTransitionDone, false);\r\n    el.removeEventListener(\"transitioncancel\", onTransitionDone, false);\r\n  };\r\n  // 绑定元素的transition完成事件，在transition完成后立即完成vue的过度动效\r\n  el.addEventListener(\"transitionend\", onTransitionDone, false);\r\n  el.addEventListener(\"transitioncancel\", onTransitionDone, false);\r\n}\r\nfunction collapseAfterEnter(el: RendererElement) {\r\n  // console.log('33, collapseAfterEnter');\r\n  // 过渡效果完成后恢复元素的maxHeight\r\n  el.style.maxHeight = \"\";\r\n  el.style.overflow = oldOverflow.value;\r\n}\r\n\r\nfunction collapseBeforeLeave(el: RendererElement) {\r\n  // console.log('44, collapseBeforeLeave', el.scrollHeight);\r\n\r\n  oldPaddingBottom.value = el.style.paddingBottom;\r\n  oldPaddingTop.value = el.style.paddingTop;\r\n  oldOverflow.value = el.style.overflow;\r\n\r\n  el.style.maxHeight = el.scrollHeight + \"px\";\r\n  el.style.overflow = \"hidden\";\r\n}\r\nfunction collapseLeave(el: RendererElement, done: () => void) {\r\n  // console.log('55, collapseLeave', el.scrollHeight);\r\n\r\n  if (el.scrollHeight !== 0) {\r\n    el.style.maxHeight = \"0\";\r\n    el.style.paddingBottom = \"0\";\r\n    el.style.paddingTop = \"0\";\r\n  }\r\n  // done();\r\n  let onTransitionDone = function () {\r\n    done();\r\n    // console.log('leave onTransitionDone');\r\n    el.removeEventListener(\"transitionend\", onTransitionDone, false);\r\n    el.removeEventListener(\"transitioncancel\", onTransitionDone, false);\r\n  };\r\n  // 绑定元素的transition完成事件，在transition完成后立即完成vue的过度动效\r\n  el.addEventListener(\"transitionend\", onTransitionDone, false);\r\n  el.addEventListener(\"transitioncancel\", onTransitionDone, false);\r\n}\r\nfunction collapseAfterLeave(el: RendererElement) {\r\n  // console.log('66, collapseAfterLeave');\r\n  el.style.maxHeight = \"\";\r\n  el.style.overflow = oldOverflow.value;\r\n  el.style.paddingBottom = oldPaddingBottom.value;\r\n  el.style.paddingTop = oldPaddingTop.value;\r\n\r\n  oldOverflow.value = oldPaddingBottom.value = oldPaddingTop.value = \"\";\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.puri-collapse-transition-enter-active,\r\n.puri-collapse-transition-leave-active {\r\n  @apply transition-all duration-500 overflow-hidden;\r\n}\r\n</style>\r\n"],"names":["model","_useModel","__props","oldPaddingTop","ref","oldPaddingBottom","oldOverflow","collapseBeforeEnter","el","value","style","paddingBottom","paddingTop","maxHeight","collapseEnter","done","overflow","elHeight","scrollHeight","onTransitionDone","removeEventListener","addEventListener","collapseAfterEnter","collapseBeforeLeave","collapseLeave","collapseAfterLeave"],"mappings":"mQAgBM,MAAAA,EAAQC,EAAAA,SAAqBC,EAAA,cAC7BC,EAAgBC,EAAAA,IAAI,EAAA,EACxBC,EAAmBD,MAAI,EACvBE,EAAAA,EAAcF,EAAAA,IAAI,EAAA,EACpB,SAASG,EAAoBC,GAEVH,EAAAI,MAAQD,EAAGE,MAAMC,cACpBR,EAAAM,MAAQD,EAAGE,MAAME,WAE/BJ,EAAGE,MAAME,WAAa,IACtBJ,EAAGE,MAAMC,cAAgB,IACzBH,EAAGE,MAAMG,UAAY,GAAA,CAEd,SAAAC,EAAcN,EAAqBO,EAG9BT,CAAAA,EAAAG,MAAQD,EAAGE,MAAMM,SAC7B,IAAIC,EAAWT,EAAGU,aAGbV,EAAAE,MAAMG,UADPI,EAAW,EACQA,EAAW,KAEX,IAEpBT,EAAAE,MAAME,WAAaT,EAAcM,MACjCD,EAAAE,MAAMC,cAAgBN,EAAiBI,MAE1CD,EAAGE,MAAMM,SAAW,SAEpB,IAAIG,EAAmB,UAAA,CAChBJ,EAEFP,EAAAA,EAAAY,oBAAoB,gBAAiBD,EAAAA,EACrCX,EAAAA,EAAAY,oBAAoB,mBAAoBD,EAAAA,EAC7C,CAAA,EAEGX,EAAAa,iBAAiB,gBAAiBF,EAAkB,EAAA,EACpDX,EAAAa,iBAAiB,mBAAoBF,EAAkB,EAAA,CAAK,CAEjE,SAASG,EAAmBd,EAG1BA,CAAAA,EAAGE,MAAMG,UAAY,GAClBL,EAAAE,MAAMM,SAAWV,EAAYG,KAAA,CAGlC,SAASc,EAAoBf,EAAAA,CAGVH,EAAAI,MAAQD,EAAGE,MAAMC,cACpBR,EAAAM,MAAQD,EAAGE,MAAME,WACnBN,EAAAG,MAAQD,EAAGE,MAAMM,SAE1BR,EAAAE,MAAMG,UAAYL,EAAGU,aAAe,KACvCV,EAAGE,MAAMM,SAAW,QAAA,CAEb,SAAAQ,EAAchB,EAAqBO,EAAAA,CAGtCP,EAAGU,eAAiB,IACtBV,EAAGE,MAAMG,UAAY,IACrBL,EAAGE,MAAMC,cAAgB,IACzBH,EAAGE,MAAME,WAAa,KAGxB,IAAIO,EAAmB,WAChBJ,EAEFP,EAAAA,EAAAY,oBAAoB,gBAAiBD,IACrCX,EAAAA,EAAAY,oBAAoB,mBAAoBD,IAC7C,CAAA,EAEGX,EAAAa,iBAAiB,gBAAiBF,EAAkB,EAAA,EACpDX,EAAAa,iBAAiB,mBAAoBF,EAAkB,EAAA,CAAK,CAEjE,SAASM,EAAmBjB,EAE1BA,CAAAA,EAAGE,MAAMG,UAAY,GAClBL,EAAAE,MAAMM,SAAWV,EAAYG,MAC7BD,EAAAE,MAAMC,cAAgBN,EAAiBI,MACvCD,EAAAE,MAAME,WAAaT,EAAcM,MAEpCH,EAAYG,MAAQJ,EAAiBI,MAAQN,EAAcM,MAAQ,EAAA"}