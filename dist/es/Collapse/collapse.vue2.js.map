{"version":3,"file":"collapse.vue2.js","sources":["../../../components/Collapse/collapse.vue"],"sourcesContent":["<template>\r\n  <Transition\r\n    @before-enter=\"collapseBeforeEnter\"\r\n    @enter=\"collapseEnter\"\r\n    @after-enter=\"collapseAfterEnter\"\r\n    @before-leave=\"collapseBeforeLeave\"\r\n    @leave=\"collapseLeave\"\r\n    @after-leave=\"collapseAfterLeave\"\r\n    name=\"puri-collapse-transition\">\r\n    <slot v-if=\"model\"></slot>\r\n  </Transition>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, type RendererElement } from \"vue\";\r\n\r\nconst model = defineModel<boolean>();\r\nconst oldPaddingTop = ref(\"\"),\r\n  oldPaddingBottom = ref(\"\"),\r\n  oldOverflow = ref(\"\");\r\nfunction collapseBeforeEnter(el: RendererElement) {\r\n  // console.log('11, collapseBeforeEnter');\r\n  oldPaddingBottom.value = el.style.paddingBottom;\r\n  oldPaddingTop.value = el.style.paddingTop;\r\n  // 过渡效果开始前设置元素的maxHeight为0，让元素maxHeight有一个初始值\r\n  el.style.paddingTop = \"0\";\r\n  el.style.paddingBottom = \"0\";\r\n  el.style.maxHeight = \"0\";\r\n}\r\nfunction collapseEnter(el: RendererElement, done: () => void) {\r\n  // console.log('22, collapseEnter');\r\n  //\r\n  oldOverflow.value = el.style.overflow;\r\n  let elHeight = el.scrollHeight;\r\n  // 过渡效果进入后将元素的maxHeight设置为元素本身的高度，将元素maxHeight设置为auto不会有过渡效果\r\n  if (elHeight > 0) {\r\n    el.style.maxHeight = elHeight + \"px\";\r\n  } else {\r\n    el.style.maxHeight = \"0\";\r\n  }\r\n  el.style.paddingTop = oldPaddingTop.value;\r\n  el.style.paddingBottom = oldPaddingBottom.value;\r\n\r\n  el.style.overflow = \"hidden\";\r\n  // done();\r\n  let onTransitionDone = function () {\r\n    done();\r\n    // console.log('enter onTransitionDone');\r\n    el.removeEventListener(\"transitionend\", onTransitionDone, false);\r\n    el.removeEventListener(\"transitioncancel\", onTransitionDone, false);\r\n  };\r\n  // 绑定元素的transition完成事件，在transition完成后立即完成vue的过度动效\r\n  el.addEventListener(\"transitionend\", onTransitionDone, false);\r\n  el.addEventListener(\"transitioncancel\", onTransitionDone, false);\r\n}\r\nfunction collapseAfterEnter(el: RendererElement) {\r\n  // console.log('33, collapseAfterEnter');\r\n  // 过渡效果完成后恢复元素的maxHeight\r\n  el.style.maxHeight = \"\";\r\n  el.style.overflow = oldOverflow.value;\r\n}\r\n\r\nfunction collapseBeforeLeave(el: RendererElement) {\r\n  // console.log('44, collapseBeforeLeave', el.scrollHeight);\r\n\r\n  oldPaddingBottom.value = el.style.paddingBottom;\r\n  oldPaddingTop.value = el.style.paddingTop;\r\n  oldOverflow.value = el.style.overflow;\r\n\r\n  el.style.maxHeight = el.scrollHeight + \"px\";\r\n  el.style.overflow = \"hidden\";\r\n}\r\nfunction collapseLeave(el: RendererElement, done: () => void) {\r\n  // console.log('55, collapseLeave', el.scrollHeight);\r\n\r\n  if (el.scrollHeight !== 0) {\r\n    el.style.maxHeight = \"0\";\r\n    el.style.paddingBottom = \"0\";\r\n    el.style.paddingTop = \"0\";\r\n  }\r\n  // done();\r\n  let onTransitionDone = function () {\r\n    done();\r\n    // console.log('leave onTransitionDone');\r\n    el.removeEventListener(\"transitionend\", onTransitionDone, false);\r\n    el.removeEventListener(\"transitioncancel\", onTransitionDone, false);\r\n  };\r\n  // 绑定元素的transition完成事件，在transition完成后立即完成vue的过度动效\r\n  el.addEventListener(\"transitionend\", onTransitionDone, false);\r\n  el.addEventListener(\"transitioncancel\", onTransitionDone, false);\r\n}\r\nfunction collapseAfterLeave(el: RendererElement) {\r\n  // console.log('66, collapseAfterLeave');\r\n  el.style.maxHeight = \"\";\r\n  el.style.overflow = oldOverflow.value;\r\n  el.style.paddingBottom = oldPaddingBottom.value;\r\n  el.style.paddingTop = oldPaddingTop.value;\r\n\r\n  oldOverflow.value = oldPaddingBottom.value = oldPaddingTop.value = \"\";\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.puri-collapse-transition-enter-active,\r\n.puri-collapse-transition-leave-active {\r\n  @apply transition-all duration-500 overflow-hidden;\r\n}\r\n</style>\r\n"],"names":["model","_useModel","__props","oldPaddingTop","ref","oldPaddingBottom","oldOverflow","collapseBeforeEnter","el","value","style","paddingBottom","paddingTop","maxHeight","collapseEnter","done","overflow","elHeight","scrollHeight","onTransitionDone","removeEventListener","addEventListener","collapseAfterEnter","collapseBeforeLeave","collapseLeave","collapseAfterLeave"],"mappings":";uIAgBM;AAAA,QAAAA,IAAQC,EAAqBC,GAAA,YAC7BC,GAAAA,IAAgBC,EAAI,EAAA,GACxBC,IAAmBD,EAAI,KACvBE,IAAcF,EAAI,EACpB;AAAA,WAASG,EAAoBC,GAAAA;AAEVH,IAAAA,EAAAI,QAAQD,EAAGE,MAAMC,eACpBR,EAAAM,QAAQD,EAAGE,MAAME,YAE/BJ,EAAGE,MAAME,aAAa,KACtBJ,EAAGE,MAAMC,gBAAgB,KACzBH,EAAGE,MAAMG,YAAY;AAAA,EAAA;AAEd,WAAAC,EAAcN,GAAqBO,GAG9BT;AAAAA,IAAAA,EAAAG,QAAQD,EAAGE,MAAMM;AAC7B,QAAIC,IAAWT,EAAGU;AAGbV,MAAAE,MAAMG,YADPI,IAAW,IACQA,IAAW,OAEX,KAEpBT,EAAAE,MAAME,aAAaT,EAAcM,OACjCD,EAAAE,MAAMC,gBAAgBN,EAAiBI,OAE1CD,EAAGE,MAAMM,WAAW;AAEpB,QAAIG,IAAmB,WAAA;AAChBJ,MAAAA,EAEFP,GAAAA,EAAAY,oBAAoB,iBAAiBD,GAAkB,EAAA,GACvDX,EAAAY,oBAAoB,oBAAoBD,GAAkB,EAAA;AAAA,IAC/D;AAEGX,MAAAa,iBAAiB,iBAAiBF,KAClCX,GAAAA,EAAAa,iBAAiB,oBAAoBF,GAAkB,EAAA;AAAA,EAAK;AAEjE,WAASG,EAAmBd,GAG1BA;AAAAA,MAAGE,MAAMG,YAAY,IAClBL,EAAAE,MAAMM,WAAWV,EAAYG;AAAAA,EAAA;AAGlC,WAASc,EAAoBf,GAAAA;AAGVH,IAAAA,EAAAI,QAAQD,EAAGE,MAAMC,eACpBR,EAAAM,QAAQD,EAAGE,MAAME,YACnBN,EAAAG,QAAQD,EAAGE,MAAMM,UAE1BR,EAAAE,MAAMG,YAAYL,EAAGU,eAAe,MACvCV,EAAGE,MAAMM,WAAW;AAAA,EAAA;AAEb,WAAAQ,EAAchB,GAAqBO,GAAAA;AAGlB,IAApBP,EAAGU,iBAAiB,MACtBV,EAAGE,MAAMG,YAAY,KACrBL,EAAGE,MAAMC,gBAAgB,KACzBH,EAAGE,MAAME,aAAa;AAGxB,QAAIO,IAAmB,WAAA;AAChBJ,MAAAA,EAEFP,GAAAA,EAAAY,oBAAoB,iBAAiBD,GAAAA,EACrCX,GAAAA,EAAAY,oBAAoB,oBAAoBD,GAAkB,EAAA;AAAA,IAC/D;AAEGX,MAAAa,iBAAiB,iBAAiBF,GAAAA,KAClCX,EAAAa,iBAAiB,oBAAoBF,GAAAA;EAAuB;AAEjE,WAASM,EAAmBjB,GAAAA;AAE1BA,MAAGE,MAAMG,YAAY,IAClBL,EAAAE,MAAMM,WAAWV,EAAYG,OAC7BD,EAAAE,MAAMC,gBAAgBN,EAAiBI,OACvCD,EAAAE,MAAME,aAAaT,EAAcM,OAEpCH,EAAYG,QAAQJ,EAAiBI,QAAQN,EAAcM,QAAQ;AAAA,EAAA;;;"}